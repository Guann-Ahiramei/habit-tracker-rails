<div>
  <h1 class="font-bold text-4xl">Users#index</h1>
  <p>Find me in app/views/users/index.html.erb</p>
  <h2>搜索用户</h2>
  <%= form_with url: users_path, method: :get, local: true do |form| %>
    <%= form.label :query, "邮箱：" %>
    <%= form.text_field :query %>
    <%= form.submit "搜索" %>
  <% end %>

  <h2>搜索结果</h2>
  <ul>
    <% @users.each do |user| %>
      <li>
        <%= user.email %>
        <% if current_user && current_user.follows_as_follower.include?(user) %>
            <%= button_to "取消关注", follows_path(user), method: :delete %>
        <% elsif current_user %>
            <%= button_to "关注", follows_path(followed_id: user.id), method: :post %>
        <% else %>
            <%= link_to "登录后关注", new_user_session_path %>
        <% end %>
      </li>
    <% end %>
  </ul>

</div>